angular bisector and tangent 2

Given is an integer sided triangle $ABC$ with $BC \le AC \le AB$.$k$ is the angular bisector of angle $ACB$.$m$ is the tangent at $C$ to the circumscribed circle of $ABC$.$n$ is a line parallel to $m$ through $B$.
The intersection of $n$ and $k$ is called $E$.



How many triangles $ABC$ with a perimeter not exceeding $1\,000\,000$ exist such that $CE$ has integral length?
Note: This problem is a more difficult version of Problem 296. Please pay close attention to the differences between the two statements.